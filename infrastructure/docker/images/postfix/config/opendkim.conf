# Liberation Platform - OpenDKIM Configuration
# Signs all outbound mail with DKIM for authenticity

# Basic settings
Syslog                  yes
SyslogSuccess           yes
LogWhy                  yes

# Canonicalization - relaxed for headers, simple for body
Canonicalization        relaxed/simple

# Signing mode only - we don't verify inbound
Mode                    s

# Signing key configuration (will be generated on first run)
Domain                  daon.network
Selector                liberation
KeyFile                 /etc/opendkim/keys/daon.network/liberation.private

# Socket for Postfix communication
Socket                  local:/var/spool/postfix/opendkim/opendkim.sock

# Permissions - socket must be accessible by postfix
Umask                   007
UserID                  opendkim:postfix

# Sign these headers
SignHeaders             From,Reply-To,Subject,Date,To,Cc,Message-ID,Content-Type,MIME-Version

# Don't sign internal headers that might change
OversignHeaders         From

# What to do if signing fails
On-BadSignature         reject
On-DNSError             tempfail
On-InternalError        accept
On-NoSignature          accept
On-Security             tempfail

# Trust only our network
InternalHosts           127.0.0.1, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16

# PID file
PidFile                 /run/opendkim/opendkim.pid

# Signing table - maps From addresses to signing keys
SigningTable            refile:/etc/opendkim/SigningTable
KeyTable                /etc/opendkim/KeyTable

# Additional domains can be added here
# ExternalIgnoreList    /etc/opendkim/TrustedHosts
